<Window x:Class="WinIsland.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="WinIsland" 
        Icon="ico.ico"
        Height="200" Width="800"
        WindowStyle="None" 
        AllowsTransparency="True" 
        Background="Transparent"
        Topmost="True"
        ResizeMode="NoResize"
        ShowInTaskbar="False"
        WindowStartupLocation="Manual"
        AllowDrop="True"
        Left="0"
        Top="0">

    <Grid>
        <Border x:Name="DynamicIsland"
                Width="120" Height="35"
                CornerRadius="17.5"
                Background="Black"
                HorizontalAlignment="Center"
                VerticalAlignment="Top"
                Margin="0,10,0,0"
                MouseDown="DynamicIsland_MouseDown"
                MouseEnter="DynamicIsland_MouseEnter"
                MouseLeave="DynamicIsland_MouseLeave"
                AllowDrop="True"
                DragEnter="DynamicIsland_DragEnter"
                DragOver="DynamicIsland_DragOver"
                DragLeave="DynamicIsland_DragLeave"
                Drop="DynamicIsland_Drop">

            <Border.Effect>
                <DropShadowEffect Color="Black" BlurRadius="20" ShadowDepth="5" Opacity="0.5"/>
            </Border.Effect>

            <Grid>
                <Grid.Resources>
                    <Style x:Key="PlayerBtnStyle" TargetType="Button">
                        <Setter Property="Background" Value="Transparent"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="Foreground" Value="White"/>
                        <Setter Property="FontSize" Value="14"/>
                        <Setter Property="Margin" Value="5,0"/>
                        <Setter Property="Cursor" Value="Hand"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Foreground" Value="#00FFCC"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Grid.Resources>

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- 通知区域 -->
                <StackPanel x:Name="NotificationPanel" Grid.Column="0" Grid.ColumnSpan="4" Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center" Visibility="Collapsed">
                    <Grid Width="24" Height="24" Margin="0,0,12,0" RenderTransformOrigin="0.5,0.5">
                        <Grid.RenderTransform>
                            <ScaleTransform x:Name="NotificationIconScale" ScaleX="1" ScaleY="1"/>
                        </Grid.RenderTransform>
                        <!-- 连接图标 (蓝牙/USB) -->
                        <Path x:Name="IconConnect" Data="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z" Fill="#00FFCC" Stretch="Uniform" Visibility="Collapsed">
                            <Path.Effect>
                                <DropShadowEffect Color="#00FFCC" BlurRadius="10" ShadowDepth="0" Opacity="0.6"/>
                            </Path.Effect>
                        </Path>
                        <!-- 断开图标 -->
                        <Path x:Name="IconDisconnect" Data="M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M17,7H7C5.9,7 5,7.9 5,9V10H6V9H17V10H18V9C18,7.9 17.1,7 17,7M17,15H7C5.9,15 5,15.9 5,17V18H6V17H17V18H18V17C18,15.9 17.1,15 17,15M7,12H17V13H7V12Z" Fill="#FF3333" Stretch="Uniform" Visibility="Collapsed">
                            <Path.Effect>
                                <DropShadowEffect Color="#FF3333" BlurRadius="10" ShadowDepth="0" Opacity="0.6"/>
                            </Path.Effect>
                        </Path>
                        <!-- 消息图标 (微信/QQ) -->
                        <Path x:Name="IconMessage" Data="M20,2H4A2,2 0 0,0 2,4V22L6,18H20A2,2 0 0,0 22,16V4A2,2 0 0,0 20,2M6,9H18V11H6M14,14H6V12H14M18,8H6V6H18" Fill="#00BFFF" Stretch="Uniform" Visibility="Collapsed">
                            <Path.Effect>
                                <DropShadowEffect Color="#00BFFF" BlurRadius="10" ShadowDepth="0" Opacity="0.6"/>
                            </Path.Effect>
                        </Path>
                    </Grid>
                    <TextBlock x:Name="NotificationText" Text="Device Connected" Foreground="White" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center">
                        <TextBlock.Effect>
                            <DropShadowEffect Color="Black" BlurRadius="2" ShadowDepth="1" Opacity="0.5"/>
                        </TextBlock.Effect>
                    </TextBlock>
                </StackPanel>

                <!-- 喝水提醒区域 -->
                <!-- 喝水提醒区域 (Premium Design) -->
                <Grid x:Name="DrinkWaterPanel" Grid.Column="0" Grid.ColumnSpan="4" VerticalAlignment="Center" HorizontalAlignment="Stretch" Visibility="Collapsed" Margin="15,0">
                    <Grid.RenderTransform>
                        <TranslateTransform Y="0"/>
                    </Grid.RenderTransform>
                    
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/> <!-- Icon -->
                        <ColumnDefinition Width="*"/>    <!-- Text -->
                        <ColumnDefinition Width="Auto"/> <!-- Button -->
                    </Grid.ColumnDefinitions>

                    <!-- 水滴图标 -->
                    <Grid Grid.Column="0" Width="36" Height="36" Margin="0,0,15,0" RenderTransformOrigin="0.5,0.5">
                        <Grid.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform x:Name="WaterIconScale" ScaleX="1" ScaleY="1"/>
                                <TranslateTransform x:Name="WaterIconTranslate" Y="0"/>
                            </TransformGroup>
                        </Grid.RenderTransform>
                        
                        <!-- 辉光背景 -->
                        <Ellipse Width="24" Height="24" HorizontalAlignment="Center" VerticalAlignment="Bottom" Opacity="0.4">
                            <Ellipse.Fill>
                                <RadialGradientBrush>
                                    <GradientStop Color="#00BFFF" Offset="0"/>
                                    <GradientStop Color="Transparent" Offset="1"/>
                                </RadialGradientBrush>
                            </Ellipse.Fill>
                            <Ellipse.Effect>
                                <BlurEffect Radius="10"/>
                            </Ellipse.Effect>
                        </Ellipse>

                        <Path Data="M12,22C16.4,22 20,18.4 20,14C20,10 12,2 12,2C12,2 4,10 4,14C4,18.4 7.6,22 12,22Z" Stretch="Uniform" Margin="2">
                            <Path.Fill>
                                <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                    <GradientStop Color="#33CCFF" Offset="0"/>
                                    <GradientStop Color="#007ACC" Offset="1"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                            <Path.Effect>
                                <DropShadowEffect Color="#00BFFF" BlurRadius="8" ShadowDepth="0" Opacity="0.6"/>
                            </Path.Effect>
                        </Path>
                    </Grid>

                    <!-- 文本信息 -->
                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <TextBlock Text="该喝水了!" Foreground="White" FontSize="16" FontWeight="Bold"/>
                        <TextBlock Text="保持健康活力，补充水分" Foreground="#AAAAAA" FontSize="11" Margin="0,3,0,0"/>
                    </StackPanel>
                    
                    <!-- 确认按钮 -->
                    <Button Grid.Column="2" Click="BtnDrank_Click" Cursor="Hand" Width="64" Height="30" BorderThickness="0" Margin="10,0,0,0">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="BtnBorder" CornerRadius="15">
                                    <Border.Effect>
                                         <DropShadowEffect Color="#007ACC" BlurRadius="5" ShadowDepth="0" Opacity="0.3"/>
                                    </Border.Effect>
                                    <Border.Background>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                            <GradientStop Color="#00BFFF" Offset="0"/>
                                            <GradientStop Color="#0066CC" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Border.Background>
                                    <TextBlock Text="已喝" Foreground="White" FontWeight="Bold" FontSize="13" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="BtnBorder" Property="Opacity" Value="0.9"/>
                                        <Setter TargetName="BtnBorder" Property="Background">
                                            <Setter.Value>
                                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                    <GradientStop Color="#33CCFF" Offset="0"/>
                                                    <GradientStop Color="#007ACC" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter TargetName="BtnBorder" Property="Opacity" Value="0.8"/>
                                        <Setter TargetName="BtnBorder" Property="RenderTransform">
                                            <Setter.Value>
                                                <ScaleTransform ScaleX="0.95" ScaleY="0.95" CenterX="32" CenterY="15"/>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </Grid>

                <!-- 待办事项提醒区域 -->
                <!-- 待办事项提醒区域 (Premium Design) -->
                <Grid x:Name="TodoPanel" Grid.Column="0" Grid.ColumnSpan="4" VerticalAlignment="Center" HorizontalAlignment="Stretch" Visibility="Collapsed" Margin="15,0">
                    <Grid.RenderTransform>
                        <TranslateTransform Y="0"/>
                    </Grid.RenderTransform>

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- 待办图标 -->
                    <Grid Grid.Column="0" Width="36" Height="36" Margin="0,0,15,0" RenderTransformOrigin="0.5,0.5">
                        <Grid.RenderTransform>
                            <RotateTransform x:Name="TodoIconRotate" Angle="0"/>
                        </Grid.RenderTransform>
                        
                        <!-- 辉光 -->
                        <Ellipse Width="24" Height="24" HorizontalAlignment="Center" VerticalAlignment="Bottom" Opacity="0.4">
                            <Ellipse.Fill>
                                <RadialGradientBrush>
                                    <GradientStop Color="#FFA500" Offset="0"/>
                                    <GradientStop Color="Transparent" Offset="1"/>
                                </RadialGradientBrush>
                            </Ellipse.Fill>
                            <Ellipse.Effect>
                                <BlurEffect Radius="10"/>
                            </Ellipse.Effect>
                        </Ellipse>

                        <Path Data="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z" Stretch="Uniform" Margin="2">
                            <Path.Fill>
                                <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                    <GradientStop Color="#FFD700" Offset="0"/>
                                    <GradientStop Color="#FF8C00" Offset="1"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                            <Path.Effect>
                                <DropShadowEffect Color="#FFA500" BlurRadius="8" ShadowDepth="0" Opacity="0.6"/>
                            </Path.Effect>
                        </Path>
                    </Grid>

                    <!-- 文本信息 -->
                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <TextBlock Text="待办事项" Foreground="White" FontSize="16" FontWeight="Bold"/>
                        <TextBlock x:Name="TxtTodoMessage" Text="Check your tasks" Foreground="#AAAAAA" FontSize="11" Margin="0,3,0,0" TextTrimming="CharacterEllipsis"/>
                    </StackPanel>

                    <!-- 完成按钮 -->
                    <Button Grid.Column="2" Click="BtnTodoDone_Click" Cursor="Hand" Width="64" Height="30" BorderThickness="0" Margin="10,0,0,0">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="BtnBorder" CornerRadius="15">
                                    <Border.Effect>
                                         <DropShadowEffect Color="#30D158" BlurRadius="5" ShadowDepth="0" Opacity="0.3"/>
                                    </Border.Effect>
                                    <Border.Background>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                            <GradientStop Color="#30D158" Offset="0"/>
                                            <GradientStop Color="#28A848" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Border.Background>
                                    <TextBlock Text="完成" Foreground="White" FontWeight="Bold" FontSize="13" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="BtnBorder" Property="Opacity" Value="0.9"/>
                                        <Setter TargetName="BtnBorder" Property="Background">
                                            <Setter.Value>
                                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                    <GradientStop Color="#32E060" Offset="0"/>
                                                    <GradientStop Color="#228C3C" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter TargetName="BtnBorder" Property="Opacity" Value="0.8"/>
                                        <Setter TargetName="BtnBorder" Property="RenderTransform">
                                             <Setter.Value>
                                                <ScaleTransform ScaleX="0.95" ScaleY="0.95" CenterX="32" CenterY="15"/>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </Grid>

                <!-- 灵动黑洞 (文件与中转站) -->
                <Grid x:Name="FileStationPanel" Grid.Column="0" Grid.ColumnSpan="4" VerticalAlignment="Center" HorizontalAlignment="Center" Visibility="Collapsed" IsHitTestVisible="True">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- 黑洞引力场背景 -->
                    <Grid Width="60" Height="60" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Grid.RenderTransform>
                            <ScaleTransform x:Name="BlackHoleScale" ScaleX="0" ScaleY="0" CenterX="30" CenterY="30"/>
                        </Grid.RenderTransform>
                         <!-- 外围吸积盘辉光 -->
                        <Ellipse Width="60" Height="60">
                            <Ellipse.Fill>
                                <RadialGradientBrush>
                                    <GradientStop Color="#4C00FFFF" Offset="0.5"/>
                                    <GradientStop Color="#00000000" Offset="1"/>
                                </RadialGradientBrush>
                            </Ellipse.Fill>
                            <Ellipse.Effect>
                                <BlurEffect Radius="10"/>
                            </Ellipse.Effect>
                        </Ellipse>
                        
                        <!-- 视界 (事件视界) -->
                        <Ellipse Width="40" Height="40" Fill="Black">
                            <Ellipse.Effect>
                                <DropShadowEffect Color="#8A2BE2" BlurRadius="15" ShadowDepth="0" Opacity="0.8"/>
                            </Ellipse.Effect>
                        </Ellipse>
                        
                        <!-- 内部漩涡 -->
                        <Path Data="M30,10 A20,20 0 1 1 10,30" Stroke="#8A2BE2" StrokeThickness="2" Opacity="0.8">
                            <Path.RenderTransform>
                                <RotateTransform x:Name="VortexRotation" Angle="0" CenterX="30" CenterY="30"/>
                            </Path.RenderTransform>
                        </Path>
                    </Grid>

                    <!-- 文件堆栈显示 (存储状态) -->
                    <Grid x:Name="FileStackDisplay" Visibility="Collapsed" MouseLeftButtonDown="FileStack_MouseDown">
                        <Grid.ToolTip>
                            <ToolTip Content="File Station: Drag out to retrieve files"/>
                        </Grid.ToolTip>
                        
                        <!-- 文件背景层 (模拟堆叠) -->
                        <Border Width="24" Height="30" Background="#33FFFFFF" CornerRadius="4" Margin="4,0,0,4" RenderTransformOrigin="0.5,0.5">
                            <Border.RenderTransform>
                                <RotateTransform Angle="10"/>
                            </Border.RenderTransform>
                        </Border>
                        
                        <!-- 主文件图标 -->
                        <Border Width="24" Height="30" Background="White" CornerRadius="4" BorderBrush="#8A2BE2" BorderThickness="1">
                             <Path Data="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z" Fill="#8A2BE2" Stretch="Uniform" Margin="4"/>
                        </Border>
                        
                        <!-- 文件数量角标 -->
                        <Border Background="Red" CornerRadius="7" Width="14" Height="14" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,-5,-5,0">
                            <TextBlock x:Name="FileCountText" Text="1" Foreground="White" FontSize="9" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="Bold"/>
                        </Border>
                    </Grid>

                    <!-- 拖拽提示文字 -->
                    <TextBlock x:Name="DropHintText" Text="Drop to Store" Foreground="White" FontSize="12" FontWeight="SemiBold" Margin="0,40,0,0" Opacity="0" HorizontalAlignment="Center"/>
                    
                </Grid>

                <Image x:Name="AlbumCover" Grid.Column="0" Width="40" Height="40" Margin="10,0,0,0" Visibility="Collapsed">
                    <Image.Clip>
                        <EllipseGeometry Center="20,20" RadiusX="20" RadiusY="20"/>
                    </Image.Clip>
                </Image>

                <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="12,0">
                    <TextBlock x:Name="SongTitle" Text="WinIsland" Foreground="White" FontSize="13" FontWeight="Bold" TextTrimming="CharacterEllipsis"/>
                </StackPanel>

                <StackPanel x:Name="ControlPanel" Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,10,0" Visibility="Collapsed">
                    <!-- 上一曲 -->
                    <Button x:Name="BtnPrev" Click="BtnPrev_Click" Style="{StaticResource PlayerBtnStyle}" Width="24" Height="24">
                        <Path Data="M6,18 L14.5,12 L6,6 L6,18 Z M15,6 L15,18 L17,18 L17,6 L15,6 Z" Fill="White" Stretch="Uniform" Width="12" Height="12"/>
                    </Button>
                    
                    <!-- 播放/暂停 -->
                    <Button x:Name="BtnPlayPause" Click="BtnPlayPause_Click" Style="{StaticResource PlayerBtnStyle}" Width="32" Height="32">
                        <Grid>
                            <Path x:Name="IconPlay" Data="M8,5 L19,12 L8,19 Z" Fill="White" Stretch="Uniform" Width="14" Height="14" Visibility="Visible"/>
                            <Path x:Name="IconPause" Data="M6,19 L10,19 L10,5 L6,5 Z M14,5 L14,19 L18,19 L18,5 Z" Fill="White" Stretch="Uniform" Width="14" Height="14" Visibility="Collapsed"/>
                        </Grid>
                    </Button>
                    
                    <!-- 下一曲 -->
                    <Button x:Name="BtnNext" Click="BtnNext_Click" Style="{StaticResource PlayerBtnStyle}" Width="24" Height="24">
                        <Path Data="M7,6 L7,18 L9,18 L9,6 L7,6 Z M9.5,12 L18,18 L18,6 L9.5,12 Z" Fill="White" Stretch="Uniform" Width="12" Height="12"/>
                    </Button>
                </StackPanel>

                <StackPanel x:Name="VisualizerContainer" Grid.Column="3" Orientation="Horizontal" Margin="0,0,15,0" VerticalAlignment="Center" Visibility="Collapsed">
                    <StackPanel.Resources>
                        <LinearGradientBrush x:Key="VisualizerBrush" StartPoint="0,1" EndPoint="0,0">
                            <GradientStop Color="#FF1DB954" Offset="0"/>
                            <GradientStop Color="#FF1ED760" Offset="1"/>
                        </LinearGradientBrush>
                    </StackPanel.Resources>
                    <Border x:Name="Bar1" Width="4" Height="4" Background="{StaticResource VisualizerBrush}" Margin="1.5" CornerRadius="2"/>
                    <Border x:Name="Bar2" Width="4" Height="8" Background="{StaticResource VisualizerBrush}" Margin="1.5" CornerRadius="2"/>
                    <Border x:Name="Bar3" Width="4" Height="12" Background="{StaticResource VisualizerBrush}" Margin="1.5" CornerRadius="2"/>
                    <Border x:Name="Bar4" Width="4" Height="8" Background="{StaticResource VisualizerBrush}" Margin="1.5" CornerRadius="2"/>
                    <Border x:Name="Bar5" Width="4" Height="4" Background="{StaticResource VisualizerBrush}" Margin="1.5" CornerRadius="2"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>